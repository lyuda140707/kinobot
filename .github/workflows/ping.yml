name: Maintenance tasks (every 10′)

on:
  schedule:
    - cron: '*/10 * * * *'
  workflow_dispatch:   # ← дозволяє запускати вручну через Actions → Run workflow

env:
  BASE_URL: https://relax-time2.onrender.com

jobs:
  tasks:
    runs-on: ubuntu-latest
    steps:
      - name: 🔆 Ping backend
        run: curl -m 5 $BASE_URL/ping

      - name: 🧹 Clean old requests
        run: curl -X POST -m 10 $BASE_URL/jobs/clean-requests

      - name: 🗑️ Delete old messages
        run: curl -X POST -m 10 $BASE_URL/jobs/delete-old-messages

      - name: 🕵️ Check pending payments
        run: curl -X POST -m 10 $BASE_URL/jobs/check-payments

      - name: 🧹 Clean expired PRO
        run: curl -X POST -m 10 $BASE_URL/clean-pro
